<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Submit Project</title>
    <style>
      :root {
        --bg: #020617;
        --card: #0b1220;
        --accent: #7c5cff;
        --accent2: #4fc3f7;
        --text: #e5e7eb;
        --muted: #9ca3af;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
      }

      body {
        min-height: 100vh;
        background: radial-gradient(circle at top, #111827, #020617);
        color: var(--text);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 30px 12px;
      }

      /* BACK BUTTON */
      .back-btn {
        position: fixed;
        top: 16px;
        left: 16px;
        padding: 8px 14px;
        background: var(--accent);
        color: #020617;
        border: none;
        border-radius: 999px;
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 600;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.4);
        display: inline-flex;
        align-items: center;
        gap: 6px;
        z-index: 50;
        transition: 0.18s ease;
      }
      .back-btn:hover {
        transform: translateY(-1px) scale(1.02);
        box-shadow: 0 10px 26px rgba(0, 0, 0, 0.6);
      }

      .container {
        width: 100%;
        max-width: 720px;
        background: radial-gradient(circle at top left, #111827, #020617);
        border-radius: 24px;
        padding: 32px 32px 26px;
        box-shadow: 0 28px 80px rgba(15, 23, 42, 0.95);
        border: 1px solid rgba(148, 163, 184, 0.3);
      }

      header {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 22px;
      }

      .logo {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        background: radial-gradient(circle at top, #22d3ee, #4f46e5);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        color: #020617;
        font-size: 1.4rem;
      }

      h1 {
        font-size: 1.9rem;
        letter-spacing: 0.03em;
      }

      .lead {
        font-size: 0.9rem;
        color: var(--muted);
        margin-top: 3px;
      }

      .form-card {
        margin-top: 4px;
        background: #020617;
        border-radius: 20px;
        padding: 20px;
        border: 1px solid rgba(148, 163, 184, 0.4);
      }

      form label {
        display: block;
        font-size: 0.9rem;
        margin-bottom: 6px;
        margin-top: 12px;
        color: #e5e7eb;
      }

      form input,
      form select,
      form textarea {
        width: 100%;
        padding: 11px 13px;
        border-radius: 12px;
        border: 1px solid rgba(148, 163, 184, 0.5);
        background: rgba(15, 23, 42, 0.9);
        color: #e5e7eb;
        font-size: 0.95rem;
        outline: none;
        transition: 0.15s;
      }

      form input:focus,
      form select:focus,
      form textarea:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 1px rgba(124, 92, 255, 0.5);
      }

      .upload-box {
        background: rgba(255, 255, 255, 0.07);
        border: 2px dashed rgba(255, 255, 255, 0.18);
        border-radius: 16px;
        padding: 20px;
        text-align: center;
        color: var(--muted);
        margin-bottom: 16px;
        cursor: pointer;
        transition: 0.2s;
        font-size: 0.95rem;
      }

      .upload-box:hover {
        border-color: var(--accent);
        background: rgba(255, 255, 255, 0.12);
        box-shadow: 0 0 12px rgba(124, 92, 255, 0.3);
      }

      .file-name {
        font-size: 0.8rem;
        color: var(--muted);
        margin-top: -8px;
        margin-bottom: 10px;
      }

      .btn-submit {
        width: 100%;
        padding: 13px;
        margin-top: 4px;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        border: none;
        border-radius: 16px;
        font-size: 1rem;
        font-weight: 700;
        color: #061226;
        cursor: pointer;
        transition: 0.2s;
        box-shadow: 0 0 18px rgba(124, 92, 255, 0.4);
      }

      .btn-submit:hover {
        transform: translateY(-1px);
        opacity: 0.95;
      }

      .success {
        margin-top: 14px;
        padding: 12px;
        border-radius: 12px;
        background: rgba(100, 255, 100, 0.08);
        border: 1px solid rgba(0, 255, 0, 0.25);
        color: #9affb1;
        display: none;
        font-size: 0.9rem;
      }

      .error {
        margin-top: 14px;
        padding: 12px;
        border-radius: 12px;
        background: rgba(248, 113, 113, 0.08);
        border: 1px solid rgba(248, 113, 113, 0.7);
        color: #fecaca;
        display: none;
        font-size: 0.9rem;
      }

      @media (max-width: 600px) {
        .container {
          padding: 22px 18px;
        }
        h1 {
          font-size: 1.6rem;
        }
      }
    </style>
  </head>

  <body>
    <!-- BACK BUTTON -->
    <button class="back-btn" onclick="history.back()">‚Üê Back</button>

    <main class="container">
      <header>
        <div class="logo">S</div>
        <div>
          <h1>Submit Your Project</h1>
          <p class="lead">
            Upload your project files, GitHub link, and details for review.
          </p>
        </div>
      </header>

      <div class="form-card">
        <form id="projectForm">
          <label>Your Name</label>
          <input
            type="text"
            name="name"
            required
            placeholder="Enter your full name"
          />

          <label>Email</label>
          <input
            type="email"
            name="email"
            required
            placeholder="Enter your email"
          />

          <label>Project Title</label>
          <input
            type="text"
            name="title"
            required
            placeholder="Enter your project title"
          />

          <label>Project Category</label>
          <select name="category" required>
            <option value="">Select category</option>
            <option>Web Development</option>
            <option>App Development</option>
            <option>AI / ML</option>
            <option>Data Science</option>
            <option>Cyber Security</option>
            <option>Python Projects</option>
            <option>C++ / Java Projects</option>
          </select>

          <label>GitHub Repository Link</label>
          <input
            type="url"
            name="github"
            required
            placeholder="https://github.com/your-username/your-repository"
          />

          <label>Project Description</label>
          <textarea
            name="description"
            rows="5"
            placeholder="Explain what your project does, features, tech used."
          ></textarea>

          <label>Upload Project File (ZIP / PDF / PPT)</label>
          <div
            class="upload-box"
            onclick="document.getElementById('file').click()"
          >
            üìÅ Click here to upload your project file
          </div>
          <input
            type="file"
            id="file"
            name="file"
            style="display: none"
            required
          />
          <div id="fileName" class="file-name"></div>

          <button type="submit" class="btn-submit">Submit Project</button>
        </form>

        <div class="success" id="successMsg">
          ‚úÖ Your project has been submitted successfully!
        </div>
        <div class="error" id="errorMsg"></div>
      </div>
    </main>

    <script>
      const form = document.getElementById("projectForm");
      const fileInput = document.getElementById("file");
      const fileName = document.getElementById("fileName");
      const successMsg = document.getElementById("successMsg");
      const errorMsg = document.getElementById("errorMsg");

      fileInput.addEventListener("change", () => {
        fileName.textContent = fileInput.files[0]
          ? fileInput.files[0].name
          : "";
      });

      form.addEventListener("submit", async function (e) {
        e.preventDefault();
        successMsg.style.display = "none";
        errorMsg.style.display = "none";

        if (!fileInput.files[0]) {
          errorMsg.textContent = "Please select a project file.";
          errorMsg.style.display = "block";
          return;
        }

        const formData = new FormData();
        formData.append("name", form.elements["name"].value);
        formData.append("email", form.elements["email"].value);
        formData.append("title", form.elements["title"].value);
        formData.append("category", form.elements["category"].value);
        formData.append("github", form.elements["github"].value);
        formData.append("description", form.elements["description"].value);
        formData.append("file", fileInput.files[0]);

        try {
          const res = await fetch("http://localhost:5000/api/projects", {
            method: "POST",
            body: formData,
          });

          const data = await res.json();

          if (!res.ok) {
            errorMsg.textContent =
              data.error || "Server error while submitting project.";
            errorMsg.style.display = "block";
            return;
          }

          // SUCCESS ‚Äì show message, clear form, then refresh page
          successMsg.textContent =
            data.message || "Project submitted successfully!";
          successMsg.style.display = "block";

          form.reset();
          fileName.textContent = "";

          // Refresh the page after 1.5 seconds (so user sees success message)
          setTimeout(() => {
            window.location.reload();
            // üëâ If you ever want to go to home page instead:
            // window.location.href = "../home.html";
          }, 1500);
        } catch (err) {
          console.error(err);
          errorMsg.textContent = "Network error. Please try again.";
          errorMsg.style.display = "block";
        }
      });
    </script>
  </body>
</html>
